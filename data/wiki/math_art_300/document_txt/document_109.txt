Lagrange multiplier - Wikipedia Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Donate Contribute Help Learn to edit Community portal Recent changes Upload file Search Search Appearance Create account Log in Personal tools Create account Log in Pages for logged out editors learn more Contributions Talk Contents move to sidebar hide (Top) 1 Summary and rationale 2 Statement 3 Single constraint 4 Multiple constraints 5 Modern formulation via differentiable manifolds Toggle Modern formulation via differentiable manifolds subsection 5.

1 Single constraint 5.

2 Multiple constraints 6 Interpretation of the Lagrange multipliers 7 Sufficient conditions 8 Examples Toggle Examples subsection 8.

1 Example 1 8.

2 Example 2 8.

3 Example 3 8.

4 Example 4 – Entropy 8.

5 Example 5 – Numerical optimization 9 Applications Toggle Applications subsection 9.

1 Control theory 9.

2 Nonlinear programming 9.

3 Power systems 9.

4 Safe Reinforcement Learning 9.

5 Normalized solutions 10 See also 11 References 12 Further reading 13 External links Toggle External links subsection 13.

1 Exposition 13.

2 Additional text and interactive applets Toggle the table of contents Lagrange multiplier 30 languages العربية Català Čeština Dansk Deutsch Español Euskara فارسی Français 한국어 हिन्दी Bahasa Indonesia Íslenska Italiano עברית Nederlands 日本語 Norsk bokmål Polski Português Română Русский Suomi Svenska Tagalog Türkçe Українська اردو Tiếng Việt 中文 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Special pages Permanent link Page information Cite this page Get shortened URL Download QR code Wikidata item Print/export Download as PDF Printable version In other projects Wikimedia Commons Appearance move to sidebar hide From Wikipedia, the free encyclopedia Method to solve constrained optimization problems "Lagrangian function" redirects here.

Not to be confused with Lagrangian (physics).

In mathematical optimization , the method of Lagrange multipliers is a strategy for finding the local maxima and minima of a function subject to equation constraints (i.

e.

, subject to the condition that one or more equations have to be satisfied exactly by the chosen values of the variables ).

[1] It is named after the mathematician Joseph-Louis Lagrange.

Summary and rationale [ edit ] The basic idea is to convert a constrained problem into a form such that the derivative test of an unconstrained problem can still be applied.

The relationship between the gradient of the function and gradients of the constraints rather naturally leads to a reformulation of the original problem, known as the Lagrangian function or Lagrangian.

[2] In the general case, the Lagrangian is defined as L ( x , λ ) ≡ f ( x ) + ⟨ λ , g ( x ) ⟩ {\displaystyle {\mathcal {L}}(x,\lambda )\equiv f(x)+\langle \lambda ,g(x)\rangle } for functions f , g {\displaystyle f,g} ; λ {\displaystyle \lambda } is called the Lagrange multiplier.

In simple cases, where the inner product is defined as the dot product , the Lagrangian is L ( x , λ ) ≡ f ( x ) + λ ⋅ g ( x ) {\displaystyle {\mathcal {L}}(x,\lambda )\equiv f(x)+\lambda \cdot g(x)} The method can be summarized as follows: in order to find the maximum or minimum of a function f {\displaystyle f} subjected to the equality constraint g ( x ) = 0 {\displaystyle g(x)=0} , find the stationary points of L {\displaystyle {\mathcal {L}}} considered as a function of x {\displaystyle x} and the Lagrange multiplier λ {\displaystyle \lambda ~}.

This means that all partial derivatives should be zero, including the partial derivative with respect to λ {\displaystyle \lambda ~}.

[3] ∂ L ∂ x = 0 {\displaystyle {\frac {\partial {\mathcal {L}}}{\partial x}}=0} and ∂ L ∂ λ = 0 ; {\displaystyle {\frac {\ \partial {\mathcal {L}}\ }{\partial \lambda }}=0\ ;} or equivalently ∂ f ( x ) ∂ x + λ ⋅ ∂ g ( x ) ∂ x = 0 {\displaystyle {\frac {\partial f(x)}{\partial x}}+\lambda \cdot {\frac {\partial g(x)}{\partial x}}=0} and g ( x ) = 0.

{\displaystyle g(x)=0~.

} The solution corresponding to the original constrained optimization is always a saddle point of the Lagrangian function, [4] [5] which can be identified among the stationary points from the definiteness of the bordered Hessian matrix.

[6] The great advantage of this method is that it allows the optimization to be solved without explicit parameterization in terms of the constraints.

As a result, the method of Lagrange multipliers is widely used to solve challenging constrained optimization problems.

Further, the method of Lagrange multipliers is generalized by the Karush–Kuhn–Tucker conditions , which can also take into account inequality constraints of the form h ( x ) ≤ c {\displaystyle h(\mathbf {x} )\leq c} for a given constant c {\displaystyle c}.

Statement [ edit ] The following is known as the Lagrange multiplier theorem.

[7] Let f : R n → R {\displaystyle f:\mathbb {R} ^{n}\to \mathbb {R} } be the objective function, g : R n → R c {\displaystyle g:\mathbb {R} ^{n}\to \mathbb {R} ^{c}} be the constraints function, both belonging to C 1 {\displaystyle C^{1}} (that is, having continuous first derivatives).

Let x ⋆ {\displaystyle x_{\star }} be an optimal solution to the following optimization problem such that, for the matrix of partial derivatives [ D ⁡ g ( x ⋆ ) ] j , k = ∂ g j ∂ x k {\displaystyle {\Bigl [}\operatorname {D} g(x_{\star }){\Bigr ]}_{j,k}={\frac {\ \partial g_{j}\ }{\partial x_{k}}}} , rank ⁡ ( D ⁡ g ( x ⋆ ) ) = c ≤ n {\displaystyle \operatorname {rank} (\operatorname {D} g(x_{\star }))=c\leq n} : maximize f ( x ) subject to: g ( x ) = 0 {\displaystyle {\begin{aligned}&{\text{maximize }}f(x)\\&{\text{subject to: }}g(x)=0\end{aligned}}} Then there exists a unique Lagrange multiplier λ ⋆ ∈ R c {\displaystyle \lambda _{\star }\in \mathbb {R} ^{c}} such that D ⁡ f ( x ⋆ ) = λ ⋆ T D ⁡ g ( x ⋆ ).

{\displaystyle \operatorname {D} f(x_{\star })=\lambda _{\star }^{\mathsf {T}}\operatorname {D} g(x_{\star })~.

} (Note that this is a somewhat conventional thing where λ ⋆ {\displaystyle \lambda _{\star }} is clearly treated as a column vector to ensure that the dimensions match.

But, we might as well make it just a row vector without taking the transpose).

The Lagrange multiplier theorem states that at any local maximum (or minimum) of the function evaluated under the equality constraints, if constraint qualification applies (explained below), then the gradient of the function (at that point) can be expressed as a linear combination of the gradients of the constraints (at that point), with the Lagrange multipliers acting as coefficients.

[8] This is equivalent to saying that any direction perpendicular to all gradients of the constraints is also perpendicular to the gradient of the function.

Or still, saying that the directional derivative of the function is 0 in every feasible direction.

Single constraint [ edit ] Figure 1: The red curve shows the constraint g ( x , y ) = c.

The blue curves are contours of f ( x , y ).

The point where the red constraint tangentially touches a blue contour is the maximum of f ( x , y ) along the constraint, since d 1 > d 2.

For the case of only one constraint and only two choice variables (as exemplified in Figure 1), consider the optimization problem maximize x , y f ( x , y ) subject to g ( x , y ) = 0.

{\displaystyle {\begin{aligned}{\underset {x,y}{\text{maximize}}}\quad &f(x,y)\\{\text{subject to}}\quad &g(x,y)=0.

\end{aligned}}} (Sometimes an additive constant is shown separately rather than being included in g {\displaystyle g} , in which case the constraint is written g ( x , y ) = c , {\displaystyle g(x,y)=c,} as in Figure 1.

) We assume that both f {\displaystyle f} and g {\displaystyle g} have continuous first partial derivatives.

We introduce a new variable ( λ {\displaystyle \lambda } ) called a Lagrange multiplier (or Lagrange undetermined multiplier ) and study the Lagrange function (or Lagrangian or Lagrangian expression ) defined by L ( x , y , λ ) = f ( x , y ) + λ ⋅ g ( x , y ) , {\displaystyle {\mathcal {L}}(x,y,\lambda )=f(x,y)+\lambda \cdot g(x,y),} where the λ {\displaystyle \lambda } term may be either added or subtracted.

If f ( x 0 , y 0 ) {\displaystyle f(x_{0},y_{0})} is a maximum of f ( x , y ) {\displaystyle f(x,y)} for the original constrained problem and ∇ g ( x 0 , y 0 ) ≠ 0 , {\displaystyle \nabla g(x_{0},y_{0})\neq 0,} then there exists λ 0 {\displaystyle \lambda _{0}} such that ( x 0 , y 0 , λ 0 {\displaystyle x_{0},y_{0},\lambda _{0}} ) is a stationary point for the Lagrange function (stationary points are those points where the first partial derivatives of L {\displaystyle {\mathcal {L}}} are zero).

The assumption ∇ g ≠ 0 {\displaystyle \nabla g\neq 0} is called constraint qualification.

However, not all stationary points yield a solution of the original problem, as the method of Lagrange multipliers yields only a necessary condition for optimality in constrained problems.

[9] [10] [11] [12] [13] Sufficient conditions for a minimum or maximum also exist , but if a particular candidate solution satisfies the sufficient conditions, it is only guaranteed that that solution is the best one locally – that is, it is better than any permissible nearby points.

The global optimum can be found by comparing the values of the original objective function at the points satisfying the necessary and locally sufficient conditions.

The method of Lagrange multipliers relies on the intuition that at a maximum, f ( x , y ) cannot be increasing in the direction of any such neighboring point that also has g = 0.

If it were, we could walk along g = 0 to get higher, meaning that the starting point wasn't actually the maximum.

Viewed in this way, it is an exact analogue to testing if the derivative of an unconstrained function is 0 , that is, we are verifying that the directional derivative is 0 in any relevant (viable) direction.

We can visualize contours of f given by f ( x , y ) = d for various values of d , and the contour of g given by g ( x , y ) = c.

Suppose we walk along the contour line with g = c.

We are interested in finding points where f almost does not change as we walk, since these points might be maxima.

There are two ways this could happen: We could touch a contour line of f , since by definition f does not change as we walk along its contour lines.

This would mean that the tangents to the contour lines of f and g are parallel here.

We have reached a "level" part of f , meaning that f does not change in any direction.

To check the first possibility (we touch a contour line of f ), notice that since the gradient of a function is perpendicular to the contour lines, the tangents to the contour lines of f and g are parallel if and only if the gradients of f and g are parallel.

Thus we want points ( x , y ) where g ( x , y ) = c and ∇ x , y f = λ ∇ x , y g , {\displaystyle \nabla _{x,y}f=\lambda \,\nabla _{x,y}g,} for some λ {\displaystyle \lambda } where ∇ x , y f = ( ∂ f ∂ x , ∂ f ∂ y ) , ∇ x , y g = ( ∂ g ∂ x , ∂ g ∂ y ) {\displaystyle \nabla _{x,y}f=\left({\frac {\partial f}{\partial x}},{\frac {\partial f}{\partial y}}\right),\qquad \nabla _{x,y}g=\left({\frac {\partial g}{\partial x}},{\frac {\partial g}{\partial y}}\right)} are the respective gradients.

The constant λ {\displaystyle \lambda } is required because although the two gradient vectors are parallel, the magnitudes of the gradient vectors are generally not equal.

This constant is called the Lagrange multiplier.

(In some conventions λ {\displaystyle \lambda } is preceded by a minus sign).

Notice that this method also solves the second possibility, that f is level: if f is level, then its gradient is zero, and setting λ = 0 {\displaystyle \lambda =0} is a solution regardless of ∇ x , y g {\displaystyle \nabla _{x,y}g}.

To incorporate these conditions into one equation, we introduce an auxiliary function L ( x , y , λ ) ≡ f ( x , y ) + λ ⋅ g ( x , y ) , {\displaystyle {\mathcal {L}}(x,y,\lambda )\equiv f(x,y)+\lambda \cdot g(x,y)\,,} and solve ∇ x , y , λ L ( x , y , λ ) = 0.

{\displaystyle \nabla _{x,y,\lambda }{\mathcal {L}}(x,y,\lambda )=0~.

} Note that this amounts to solving three equations in three unknowns.

This is the method of Lagrange multipliers.

Note that ∇ λ L ( x , y , λ ) = 0 {\displaystyle \ \nabla _{\lambda }{\mathcal {L}}(x,y,\lambda )=0\ } implies g ( x , y ) = 0 , {\displaystyle \ g(x,y)=0\ ,} as the partial derivative of L {\displaystyle {\mathcal {L}}} with respect to λ {\displaystyle \lambda } is g ( x , y ).

{\displaystyle \ g(x,y)~.

} To summarize ∇ x , y , λ L ( x , y , λ ) = 0 ⟺ { ∇ x , y f ( x , y ) = − λ ∇ x , y g ( x , y ) g ( x , y ) = 0 {\displaystyle \nabla _{x,y,\lambda }{\mathcal {L}}(x,y,\lambda )=0\iff {\begin{cases}\nabla _{x,y}f(x,y)=-\lambda \,\nabla _{x,y}g(x,y)\\g(x,y)=0\end{cases}}} The method generalizes readily to functions on n {\displaystyle n} variables ∇ x 1 , … , x n , λ L ( x 1 , … , x n , λ ) = 0 {\displaystyle \nabla _{x_{1},\dots ,x_{n},\lambda }{\mathcal {L}}(x_{1},\dots ,x_{n},\lambda )=0} which amounts to solving n + 1 equations in n + 1 unknowns.

The constrained extrema of f are critical points of the Lagrangian L {\displaystyle {\mathcal {L}}} , but they are not necessarily local extrema of L {\displaystyle {\mathcal {L}}} (see § Example 2 below).

One may reformulate the Lagrangian as a Hamiltonian , in which case the solutions are local minima for the Hamiltonian.

This is done in optimal control theory, in the form of Pontryagin's minimum principle.

The fact that solutions of the method of Lagrange multipliers are not necessarily extrema of the Lagrangian, also poses difficulties for numerical optimization.

This can be addressed by minimizing the magnitude of the gradient of the Lagrangian, as these minima are the same as the zeros of the magnitude, as illustrated in Example 5: Numerical optimization.

Multiple constraints [ edit ] Figure 2: A paraboloid constrained along two intersecting lines.

Figure 3: Contour map of Figure 2.

The method of Lagrange multipliers can be extended to solve problems with multiple constraints using a similar argument.

Consider a paraboloid subject to two line constraints that intersect at a single point.

As the only feasible solution, this point is obviously a constrained extremum.

However, the level set of f {\displaystyle f} is clearly not parallel to either constraint at the intersection point (see Figure 3); instead, it is a linear combination of the two constraints' gradients.

In the case of multiple constraints, that will be what we seek in general: The method of Lagrange seeks points not at which the gradient of f {\displaystyle f} is multiple of any single constraint's gradient necessarily, but in which it is a linear combination of all the constraints' gradients.

Concretely, suppose we have M {\displaystyle M} constraints and are walking along the set of points satisfying g i ( x ) = 0 , i = 1 , … , M.

{\displaystyle g_{i}(\mathbf {x} )=0,i=1,\dots ,M\,.

} Every point x {\displaystyle \mathbf {x} } on the contour of a given constraint function g i {\displaystyle g_{i}} has a space of allowable directions: the space of vectors perpendicular to ∇ g i ( x ).

{\displaystyle \nabla g_{i}(\mathbf {x} )\,.

} The set of directions that are allowed by all constraints is thus the space of directions perpendicular to all of the constraints' gradients.

Denote this space of allowable moves by A {\displaystyle \ A\ } and denote the span of the constraints' gradients by S.

{\displaystyle S\,.

} Then A = S ⊥ , {\displaystyle A=S^{\perp }\,,} the space of vectors perpendicular to every element of S.

{\displaystyle S\,.

} We are still interested in finding points where f {\displaystyle f} does not change as we walk, since these points might be (constrained) extrema.

We therefore seek x {\displaystyle \mathbf {x} } such that any allowable direction of movement away from x {\displaystyle \mathbf {x} } is perpendicular to ∇ f ( x ) {\displaystyle \nabla f(\mathbf {x} )} (otherwise we could increase f {\displaystyle f} by moving along that allowable direction).

In other words, ∇ f ( x ) ∈ A ⊥ = S.

{\displaystyle \nabla f(\mathbf {x} )\in A^{\perp }=S\,.

} Thus there are scalars λ 1 , λ 2 , … , λ M {\displaystyle \lambda _{1},\lambda _{2},\ \dots ,\lambda _{M}} such that ∇ f ( x ) = ∑ k = 1 M λ k ∇ g k ( x ) ⟺ ∇ f ( x ) − ∑ k = 1 M λ k ∇ g k ( x ) = 0.

{\displaystyle \nabla f(\mathbf {x} )=\sum _{k=1}^{M}\lambda _{k}\,\nabla g_{k}(\mathbf {x} )\quad \iff \quad \nabla f(\mathbf {x} )-\sum _{k=1}^{M}{\lambda _{k}\nabla g_{k}(\mathbf {x} )}=0~.

} These scalars are the Lagrange multipliers.

We now have M {\displaystyle M} of them, one for every constraint.

As before, we introduce an auxiliary function L ( x 1 , … , x n , λ 1 , … , λ M ) = f ( x 1 , … , x n ) − ∑ k = 1 M λ k g k ( x 1 , … , x n ) {\displaystyle {\mathcal {L}}\left(x_{1},\ldots ,x_{n},\lambda _{1},\ldots ,\lambda _{M}\right)=f\left(x_{1},\ldots ,x_{n}\right)-\sum \limits _{k=1}^{M}{\lambda _{k}g_{k}\left(x_{1},\ldots ,x_{n}\right)}\ } and solve ∇ x 1 , … , x n , λ 1 , … , λ M L ( x 1 , … , x n , λ 1 , … , λ M ) = 0 ⟺ { ∇ f ( x ) − ∑ k = 1 M λ k ∇ g k ( x ) = 0 g 1 ( x ) = ⋯ = g M ( x ) = 0 {\displaystyle \nabla _{x_{1},\ldots ,x_{n},\lambda _{1},\ldots ,\lambda _{M}}{\mathcal {L}}(x_{1},\ldots ,x_{n},\lambda _{1},\ldots ,\lambda _{M})=0\iff {\begin{cases}\nabla f(\mathbf {x} )-\sum _{k=1}^{M}{\lambda _{k}\,\nabla g_{k}(\mathbf {x} )}=0\\g_{1}(\mathbf {x} )=\cdots =g_{M}(\mathbf {x} )=0\end{cases}}} which amounts to solving n + M {\displaystyle n+M} equations in n + M {\displaystyle \ n+M\ } unknowns.

The constraint qualification assumption when there are multiple constraints is that the constraint gradients at the relevant point are linearly independent.

Modern formulation via differentiable manifolds [ edit ] The problem of finding the local maxima and minima subject to constraints can be generalized to finding local maxima and minima on a differentiable manifold M.

{\displaystyle \ M~.

} [14] In what follows, it is not necessary that M {\displaystyle M} be a Euclidean space, or even a Riemannian manifold.

All appearances of the gradient ∇ {\displaystyle \ \nabla \ } (which depends on a choice of Riemannian metric) can be replaced with the exterior derivative d ⁡.

{\displaystyle \ \operatorname {d} ~.

} Single constraint [ edit ] Let M {\displaystyle \ M\ } be a smooth manifold of dimension m.

{\displaystyle \ m~.

} Suppose that we wish to find the stationary points x {\displaystyle \ x\ } of a smooth function f : M → R {\displaystyle \ f:M\to \mathbb {R} \ } when restricted to the submanifold N {\displaystyle \ N\ } defined by g ( x ) = 0 , {\displaystyle \ g(x)=0\ ,} where g : M → R {\displaystyle \ g:M\to \mathbb {R} \ } is a smooth function for which 0 is a regular value.

Let d ⁡ f {\displaystyle \ \operatorname {d} f\ } and d ⁡ g {\displaystyle \ \operatorname {d} g\ } be the exterior derivatives of f {\displaystyle \ f\ } and g {\displaystyle \ g\ }.

Stationarity for the restriction f | N {\displaystyle \ f|_{N}\ } at x ∈ N {\displaystyle \ x\in N\ } means d ⁡ ( f | N ) x = 0.

{\displaystyle \ \operatorname {d} (f|_{N})_{x}=0~.

} Equivalently, the kernel ker ⁡ ( d ⁡ f x ) {\displaystyle \ \ker(\operatorname {d} f_{x})\ } contains T x N = ker ⁡ ( d ⁡ g x ).

{\displaystyle \ T_{x}N=\ker(\operatorname {d} g_{x})~.

} In other words, d ⁡ f x {\displaystyle \ \operatorname {d} f_{x}\ } and d ⁡ g x {\displaystyle \ \operatorname {d} g_{x}\ } are proportional 1-forms.

For this it is necessary and sufficient that the following system of 1 2 m ( m − 1 ) {\displaystyle \ {\tfrac {1}{2}}m(m-1)\ } equations holds: d ⁡ f x ∧ d ⁡ g x = 0 ∈ Λ 2 ( T x ∗ M ) {\displaystyle \operatorname {d} f_{x}\wedge \operatorname {d} g_{x}=0\in \Lambda ^{2}(T_{x}^{\ast }M)} where ∧ {\displaystyle \ \wedge \ } denotes the exterior product.

The stationary points x {\displaystyle \ x\ } are the solutions of the above system of equations plus the constraint g ( x ) = 0.

{\displaystyle \ g(x)=0~.

} Note that the 1 2 m ( m − 1 ) {\displaystyle \ {\tfrac {1}{2}}m(m-1)\ } equations are not independent, since the left-hand side of the equation belongs to the subvariety of Λ 2 ( T x ∗ M ) {\displaystyle \ \Lambda ^{2}(T_{x}^{\ast }M)\ } consisting of decomposable elements.

In this formulation, it is not necessary to explicitly find the Lagrange multiplier, a number λ {\displaystyle \ \lambda \ } such that d ⁡ f x = λ ⋅ d ⁡ g x.

{\displaystyle \ \operatorname {d} f_{x}=\lambda \cdot \operatorname {d} g_{x}~.

} Multiple constraints [ edit ] Let M {\displaystyle \ M\ } and f {\displaystyle \ f\ } be as in the above section regarding the case of a single constraint.

Rather than the function g {\displaystyle g} described there, now consider a smooth function G : M → R p ( p > 1 ) , {\displaystyle \ G:M\to \mathbb {R} ^{p}(p>1)\ ,} with component functions g i : M → R , {\displaystyle \ g_{i}:M\to \mathbb {R} \ ,} for which 0 ∈ R p {\displaystyle 0\in \mathbb {R} ^{p}} is a regular value.

Let N {\displaystyle N} be the submanifold of M {\displaystyle \ M\ } defined by G ( x ) = 0.

{\displaystyle \ G(x)=0~.

} x {\displaystyle \ x\ } is a stationary point of f | N {\displaystyle f|_{N}} if and only if ker ⁡ ( d ⁡ f x ) {\displaystyle \ \ker(\operatorname {d} f_{x})\ } contains ker ⁡ ( d ⁡ G x ).

{\displaystyle \ \ker(\operatorname {d} G_{x})~.

} For convenience let L x = d ⁡ f x {\displaystyle \ L_{x}=\operatorname {d} f_{x}\ } and K x = d ⁡ G x , {\displaystyle \ K_{x}=\operatorname {d} G_{x}\ ,} where d ⁡ G {\displaystyle \ \operatorname {d} G} denotes the tangent map or Jacobian T M → T R p {\displaystyle \ TM\to T\mathbb {R} ^{p}~} ( T x R p {\displaystyle \ T_{x}\mathbb {R} ^{p}} can be canonically identified with R p {\displaystyle \ \mathbb {R} ^{p}} ).

The subspace ker ⁡ ( K x ) {\displaystyle \ker(K_{x})} has dimension smaller than that of ker ⁡ ( L x ) {\displaystyle \ker(L_{x})} , namely dim ⁡ ( ker ⁡ ( L x ) ) = n − 1 {\displaystyle \ \dim(\ker(L_{x}))=n-1\ } and dim ⁡ ( ker ⁡ ( K x ) ) = n − p.

{\displaystyle \ \dim(\ker(K_{x}))=n-p~.

} ker ⁡ ( K x ) {\displaystyle \ker(K_{x})} belongs to ker ⁡ ( L x ) {\displaystyle \ \ker(L_{x})\ } if and only if L x ∈ T x ∗ M {\displaystyle L_{x}\in T_{x}^{\ast }M} belongs to the image of K x ∗ : R p ∗ → T x ∗ M.

{\displaystyle \ K_{x}^{\ast }:\mathbb {R} ^{p\ast }\to T_{x}^{\ast }M~.

} Computationally speaking, the condition is that L x {\displaystyle L_{x}} belongs to the row space of the matrix of K x , {\displaystyle \ K_{x}\ ,} or equivalently the column space of the matrix of K x ∗ {\displaystyle K_{x}^{\ast }} (the transpose).

If ω x ∈ Λ p ( T x ∗ M ) {\displaystyle \ \omega _{x}\in \Lambda ^{p}(T_{x}^{\ast }M)\ } denotes the exterior product of the columns of the matrix of K x ∗ , {\displaystyle \ K_{x}^{\ast }\ ,} the stationary condition for f | N {\displaystyle \ f|_{N}\ } at x {\displaystyle \ x\ } becomes L x ∧ ω x = 0 ∈ Λ p + 1 ( T x ∗ M ) {\displaystyle L_{x}\wedge \omega _{x}=0\in \Lambda ^{p+1}\left(T_{x}^{\ast }M\right)} Once again, in this formulation it is not necessary to explicitly find the Lagrange multipliers, the numbers λ 1 , … , λ p {\displaystyle \ \lambda _{1},\ldots ,\lambda _{p}\ } such that d ⁡ f x = ∑ i = 1 p λ i d ⁡ ( g i ) x.

{\displaystyle \ \operatorname {d} f_{x}=\sum _{i=1}^{p}\lambda _{i}\operatorname {d} (g_{i})_{x}~.

} Interpretation of the Lagrange multipliers [ edit ] In this section, we modify the constraint equations from the form g i ( x ) = 0 {\displaystyle g_{i}({\bf {x}})=0} to the form g i ( x ) = c i , {\displaystyle \ g_{i}({\bf {x}})=c_{i}\ ,} where the c i {\displaystyle \ c_{i}\ } are m real constants that are considered to be additional arguments of the Lagrangian expression L {\displaystyle {\mathcal {L}}}.

Often the Lagrange multipliers have an interpretation as some quantity of interest.

For example, by parametrising the constraint's contour line, that is, if the Lagrangian expression is L ( x 1 , x 2 , … ; λ 1 , λ 2 , … ; c 1 , c 2 , … ) = f ( x 1 , x 2 , … ) + λ 1 ( c 1 − g 1 ( x 1 , x 2 , … ) ) + λ 2 ( c 2 − g 2 ( x 1 , x 2 , … ) ) + ⋯ {\displaystyle {\begin{aligned}&{\mathcal {L}}(x_{1},x_{2},\ldots ;\lambda _{1},\lambda _{2},\ldots ;c_{1},c_{2},\ldots )\\[4pt]={}&f(x_{1},x_{2},\ldots )+\lambda _{1}(c_{1}-g_{1}(x_{1},x_{2},\ldots ))+\lambda _{2}(c_{2}-g_{2}(x_{1},x_{2},\dots ))+\cdots \end{aligned}}} then ∂ L ∂ c k = λ k.

{\displaystyle \ {\frac {\partial {\mathcal {L}}}{\partial c_{k}}}=\lambda _{k}~.

} So, λ k is the rate of change of the quantity being optimized as a function of the constraint parameter.

As examples, in Lagrangian mechanics the equations of motion are derived by finding stationary points of the action , the time integral of the difference between kinetic and potential energy.

Thus, the force on a particle due to a scalar potential, F = −∇ V , can be interpreted as a Lagrange multiplier determining the change in action (transfer of potential to kinetic energy) following a variation in the particle's constrained trajectory.

In control theory this is formulated instead as costate equations.

Moreover, by the envelope theorem the optimal value of a Lagrange multiplier has an interpretation as the marginal effect of the corresponding constraint constant upon the optimal attainable value of the original objective function: If we denote values at the optimum with a star ( ⋆ {\displaystyle \star } ), then it can be shown that d ⁡ f ( x 1 ⋆ ( c 1 , c 2 , … ) , x 2 ⋆ ( c 1 , c 2 , … ) , … ) d ⁡ c k = λ ⋆ k.

{\displaystyle {\frac {\ \operatorname {d} f\left(\ x_{1\star }(c_{1},c_{2},\dots ),\ x_{2\star }(c_{1},c_{2},\dots ),\ \dots \ \right)\ }{\operatorname {d} c_{k}}}=\lambda _{\star k}~.

} For example, in economics the optimal profit to a player is calculated subject to a constrained space of actions, where a Lagrange multiplier is the change in the optimal value of the objective function (profit) due to the relaxation of a given constraint (e.

g.

through a change in income); in such a context λ ⋆ k {\displaystyle \ \lambda _{\star k}\ } is the marginal cost of the constraint, and is referred to as the shadow price.

[15] Sufficient conditions [ edit ] Main article: Bordered Hessian Sufficient conditions for a constrained local maximum or minimum can be stated in terms of a sequence of principal minors (determinants of upper-left-justified sub-matrices) of the bordered Hessian matrix of second derivatives of the Lagrangian expression.

[6] [16] Examples [ edit ] Example 1 [ edit ] Illustration of the constrained optimization problem 1 Suppose we wish to maximize f ( x , y ) = x + y {\displaystyle \ f(x,y)=x+y\ } subject to the constraint x 2 + y 2 = 1.

{\displaystyle \ x^{2}+y^{2}=1~.

} The feasible set is the unit circle, and the level sets of f are diagonal lines (with slope −1), so we can see graphically that the maximum occurs at ( 1 2 , 1 2 ) , {\displaystyle \ \left({\tfrac {1}{\sqrt {2}}},{\tfrac {1}{\sqrt {2}}}\right)\ ,} and that the minimum occurs at ( − 1 2 , − 1 2 ).

{\displaystyle \ \left(-{\tfrac {1}{\sqrt {2}}},-{\tfrac {1}{\sqrt {2}}}\right)~.

} For the method of Lagrange multipliers, the constraint is g ( x , y ) = x 2 + y 2 − 1 = 0 , {\displaystyle g(x,y)=x^{2}+y^{2}-1=0\ ,} hence the Lagrangian function, L ( x , y , λ ) = f ( x , y ) + λ ⋅ g ( x , y ) = x + y + λ ( x 2 + y 2 − 1 ) , {\displaystyle {\begin{aligned}{\mathcal {L}}(x,y,\lambda )&=f(x,y)+\lambda \cdot g(x,y)\\[4pt]&=x+y+\lambda (x^{2}+y^{2}-1)\ ,\end{aligned}}} is a function that is equivalent to f ( x , y ) {\displaystyle \ f(x,y)\ } when g ( x , y ) {\displaystyle \ g(x,y)\ } is set to 0.

Now we can calculate the gradient: ∇ x , y , λ L ( x , y , λ ) = ( ∂ L ∂ x , ∂ L ∂ y , ∂ L ∂ λ ) = ( 1 + 2 λ x , 1 + 2 λ y , x 2 + y 2 − 1 ) , {\displaystyle {\begin{aligned}\nabla _{x,y,\lambda }{\mathcal {L}}(x,y,\lambda )&=\left({\frac {\partial {\mathcal {L}}}{\partial x}},{\frac {\partial {\mathcal {L}}}{\partial y}},{\frac {\partial {\mathcal {L}}}{\partial \lambda }}\right)\\[4pt]&=\left(1+2\lambda x,1+2\lambda y,x^{2}+y^{2}-1\right)\ \color {gray}{,}\end{aligned}}} and therefore: ∇ x , y , λ L ( x , y , λ ) = 0 ⇔ { 1 + 2 λ x = 0 1 + 2 λ y = 0 x 2 + y 2 − 1 = 0 {\displaystyle \nabla _{x,y,\lambda }{\mathcal {L}}(x,y,\lambda )=0\quad \Leftrightarrow \quad {\begin{cases}1+2\lambda x=0\\1+2\lambda y=0\\x^{2}+y^{2}-1=0\end{cases}}} Notice that the last equation is the original constraint.

The first two equations yield x = y = − 1 2 λ , λ ≠ 0.

{\displaystyle x=y=-{\frac {1}{2\lambda }},\qquad \lambda \neq 0~.

} By substituting into the last equation we have: 1 4 λ 2 + 1 4 λ 2 − 1 = 0 , {\displaystyle {\frac {1}{4\lambda ^{2}}}+{\frac {1}{4\lambda ^{2}}}-1=0\ ,} so λ = ± 1 2 , {\displaystyle \lambda =\pm {\frac {1}{\sqrt {2\ }}}\ ,} which implies that the stationary points of L {\displaystyle {\mathcal {L}}} are ( 2 2 , 2 2 , − 1 2 ) , ( − 2 2 , − 2 2 , 1 2 ).

{\displaystyle \left({\tfrac {\sqrt {2\ }}{2}},{\tfrac {\sqrt {2\ }}{2}},-{\tfrac {1}{\sqrt {2\ }}}\right),\qquad \left(-{\tfrac {\sqrt {2\ }}{2}},-{\tfrac {\sqrt {2\ }}{2}},{\tfrac {1}{\sqrt {2\ }}}\right)~.

} Evaluating the objective function f at these points yields f ( 2 2 , 2 2 ) = 2 , f ( − 2 2 , − 2 2 ) = − 2.

{\displaystyle f\left({\tfrac {\sqrt {2\ }}{2}},{\tfrac {\sqrt {2\ }}{2}}\right)={\sqrt {2\ }}\ ,\qquad f\left(-{\tfrac {\sqrt {2\ }}{2}},-{\tfrac {\sqrt {2\ }}{2}}\right)=-{\sqrt {2\ }}~.

} Thus the constrained maximum is 2 {\displaystyle \ {\sqrt {2\ }}\ } and the constrained minimum is − 2 {\displaystyle -{\sqrt {2}}}.

Example 2 [ edit ] Illustration of the constrained optimization problem 2 Now we modify the objective function of Example 1 so that we minimize f ( x , y ) = ( x + y ) 2 {\displaystyle \ f(x,y)=(x+y)^{2}\ } instead of f ( x , y ) = x + y , {\displaystyle \ f(x,y)=x+y\ ,} again along the circle g ( x , y ) = x 2 + y 2 − 1 = 0.

{\displaystyle \ g(x,y)=x^{2}+y^{2}-1=0~.

} Now the level sets of f {\displaystyle f} are still lines of slope −1, and the points on the circle tangent to these level sets are again ( 2 / 2 , 2 / 2 ) {\displaystyle \ ({\sqrt {2}}/2,{\sqrt {2}}/2)\ } and ( − 2 / 2 , − 2 / 2 ).

{\displaystyle \ (-{\sqrt {2}}/2,-{\sqrt {2}}/2)~.

} These tangency points are maxima of f.

{\displaystyle \ f~.

} On the other hand, the minima occur on the level set for f = 0 {\displaystyle \ f=0\ } (since by its construction f {\displaystyle \ f\ } cannot take negative values), at ( 2 / 2 , − 2 / 2 ) {\displaystyle \ ({\sqrt {2}}/2,-{\sqrt {2}}/2)\ } and ( − 2 / 2 , 2 / 2 ) , {\displaystyle \ (-{\sqrt {2}}/2,{\sqrt {2}}/2)\ ,} where the level curves of f {\displaystyle \ f\ } are not tangent to the constraint.

The condition that ∇ x , y , λ ( f ( x , y ) + λ ⋅ g ( x , y ) ) = 0 {\displaystyle \ \nabla _{x,y,\lambda }\left(f(x,y)+\lambda \cdot g(x,y)\right)=0\ } correctly identifies all four points as extrema; the minima are characterized in by λ = 0 {\displaystyle \ \lambda =0\ } and the maxima by λ = 2.

{\displaystyle \ \lambda =2~.

} Example 3 [ edit ] Illustration of constrained optimization problem 3.

This example deals with more strenuous calculations, but it is still a single constraint problem.

Suppose one wants to find the maximum values of f ( x , y ) = x 2 y {\displaystyle f(x,y)=x^{2}y} with the condition that the x {\displaystyle \ x\ } - and y {\displaystyle \ y\ } -coordinates lie on the circle around the origin with radius 3.

{\displaystyle \ {\sqrt {3\ }}~.

} That is, subject to the constraint g ( x , y ) = x 2 + y 2 − 3 = 0.

{\displaystyle g(x,y)=x^{2}+y^{2}-3=0~.

} As there is just a single constraint, there is a single multiplier, say λ.

{\displaystyle \ \lambda ~.

} The constraint g ( x , y ) {\displaystyle \ g(x,y)\ } is identically zero on the circle of radius 3.

{\displaystyle \ {\sqrt {3\ }}~.

} Any multiple of g ( x , y ) {\displaystyle \ g(x,y)\ } may be added to g ( x , y ) {\displaystyle \ g(x,y)\ } leaving g ( x , y ) {\displaystyle \ g(x,y)\ } unchanged in the region of interest (on the circle where our original constraint is satisfied).

Applying the ordinary Lagrange multiplier method yields L ( x , y , λ ) = f ( x , y ) + λ ⋅ g ( x , y ) = x 2 y + λ ( x 2 + y 2 − 3 ) , {\displaystyle {\begin{aligned}{\mathcal {L}}(x,y,\lambda )&=f(x,y)+\lambda \cdot g(x,y)\\&=x^{2}y+\lambda (x^{2}+y^{2}-3)\ ,\end{aligned}}} from which the gradient can be calculated: ∇ x , y , λ L ( x , y , λ ) = ( ∂ L ∂ x , ∂ L ∂ y , ∂ L ∂ λ ) = ( 2 x y + 2 λ x , x 2 + 2 λ y , x 2 + y 2 − 3 ).

{\displaystyle {\begin{aligned}\nabla _{x,y,\lambda }{\mathcal {L}}(x,y,\lambda )&=\left({\frac {\partial {\mathcal {L}}}{\partial x}},{\frac {\partial {\mathcal {L}}}{\partial y}},{\frac {\partial {\mathcal {L}}}{\partial \lambda }}\right)\\&=\left(2xy+2\lambda x,x^{2}+2\lambda y,x^{2}+y^{2}-3\right)~.

\end{aligned}}} And therefore: ∇ x , y , λ L ( x , y , λ ) = 0 ⟺ { 2 x y + 2 λ x = 0 x 2 + 2 λ y = 0 x 2 + y 2 − 3 = 0 ⟺ { x ( y + λ ) = 0 (i) x 2 = − 2 λ y (ii) x 2 + y 2 = 3 (iii) {\displaystyle \nabla _{x,y,\lambda }{\mathcal {L}}(x,y,\lambda )=0\quad \iff \quad {\begin{cases}2xy+2\lambda x=0\\x^{2}+2\lambda y=0\\x^{2}+y^{2}-3=0\end{cases}}\quad \iff \quad {\begin{cases}x(y+\lambda )=0&{\text{(i)}}\\x^{2}=-2\lambda y&{\text{(ii)}}\\x^{2}+y^{2}=3&{\text{(iii)}}\end{cases}}} (iii) is just the original constraint.

(i) implies x = 0 {\displaystyle \ x=0\ } or λ = − y.

{\displaystyle \ \lambda =-y~.

} If x = 0 {\displaystyle x=0} then y = ± 3 {\displaystyle \ y=\pm {\sqrt {3\ }}\ } by (iii) and consequently λ = 0 {\displaystyle \ \lambda =0\ } from (ii).

If λ = − y , {\displaystyle \ \lambda =-y\ ,} substituting this into (ii) yields x 2 = 2 y 2.

{\displaystyle \ x^{2}=2y^{2}~.

} Substituting this into (iii) and solving for y {\displaystyle \ y\ } gives y = ± 1.

{\displaystyle \ y=\pm 1~.

} Thus there are six critical points of L : {\displaystyle \ {\mathcal {L}}\ :} ( 2 , 1 , − 1 ) ; ( − 2 , 1 , − 1 ) ; ( 2 , − 1 , 1 ) ; ( − 2 , − 1 , 1 ) ; ( 0 , 3 , 0 ) ; ( 0 , − 3 , 0 ).

{\displaystyle ({\sqrt {2\ }},1,-1);\quad (-{\sqrt {2\ }},1,-1);\quad ({\sqrt {2\ }},-1,1);\quad (-{\sqrt {2\ }},-1,1);\quad (0,{\sqrt {3\ }},0);\quad (0,-{\sqrt {3\ }},0)~.

} Evaluating the objective at these points, one finds that f ( ± 2 , 1 ) = 2 ; f ( ± 2 , − 1 ) = − 2 ; f ( 0 , ± 3 ) = 0.

{\displaystyle f(\pm {\sqrt {2\ }},1)=2;\quad f(\pm {\sqrt {2\ }},-1)=-2;\quad f(0,\pm {\sqrt {3\ }})=0~.

} Therefore, the objective function attains the global maximum (subject to the constraints) at ( ± 2 , 1 ) {\displaystyle \ (\pm {\sqrt {2\ }},1\ )} and the global minimum at ( ± 2 , − 1 ).

{\displaystyle \ (\pm {\sqrt {2\ }},-1)~.

} The point ( 0 , 3 ) {\displaystyle \ (0,{\sqrt {3\ }})\ } is a local minimum of f {\displaystyle \ f\ } and ( 0 , − 3 ) {\displaystyle \ (0,-{\sqrt {3\ }})\ } is a local maximum of f , {\displaystyle \ f\ ,} as may be determined by consideration of the Hessian matrix of L ( x , y , 0 ).

{\displaystyle \ {\mathcal {L}}(x,y,0)~.

} Note that while ( 2 , 1 , − 1 ) {\displaystyle \ ({\sqrt {2\ }},1,-1)\ } is a critical point of L , {\displaystyle \ {\mathcal {L}}\ ,} it is not a local extremum of L.

{\displaystyle \ {\mathcal {L}}~.

} We have L ( 2 + ε , 1 , − 1 + δ ) = 2 + δ ( ε 2 + ( 2 2 ) ε ).

{\displaystyle {\mathcal {L}}\left({\sqrt {2\ }}+\varepsilon ,1,-1+\delta \right)=2+\delta \left(\varepsilon ^{2}+\left(2{\sqrt {2\ }}\right)\varepsilon \right)~.

} Given any neighbourhood of ( 2 , 1 , − 1 ) , {\displaystyle \ ({\sqrt {2\ }},1,-1)\ ,} one can choose a small positive ε {\displaystyle \ \varepsilon \ } and a small δ {\displaystyle \ \delta \ } of either sign to get L {\displaystyle \ {\mathcal {L}}} values both greater and less than 2.

{\displaystyle \ 2~.

} This can also be seen from the Hessian matrix of L {\displaystyle \ {\mathcal {L}}\ } evaluated at this point (or indeed at any of the critical points) which is an indefinite matrix.

Each of the critical points of L {\displaystyle \ {\mathcal {L}}\ } is a saddle point of L.

{\displaystyle \ {\mathcal {L}}~.

} [4] Example 4 – Entropy [ edit ] Suppose we wish to find the discrete probability distribution on the points { p 1 , p 2 , … , p n } {\displaystyle \ \{p_{1},p_{2},\ldots ,p_{n}\}\ } with maximal information entropy.

This is the same as saying that we wish to find the least structured probability distribution on the points { p 1 , p 2 , ⋯ , p n }.

{\displaystyle \ \{p_{1},p_{2},\cdots ,p_{n}\}~.

} In other words, we wish to maximize the Shannon entropy equation: f ( p 1 , p 2 , … , p n ) = − ∑ j = 1 n p j log 2 ⁡ p j.

{\displaystyle f(p_{1},p_{2},\ldots ,p_{n})=-\sum _{j=1}^{n}p_{j}\log _{2}p_{j}~.

} For this to be a probability distribution the sum of the probabilities p i {\displaystyle \ p_{i}\ } at each point x i {\displaystyle \ x_{i}\ } must equal 1, so our constraint is: g ( p 1 , p 2 , … , p n ) = ∑ j = 1 n p j = 1.

{\displaystyle g(p_{1},p_{2},\ldots ,p_{n})=\sum _{j=1}^{n}p_{j}=1~.

} We use Lagrange multipliers to find the point of maximum entropy, p → ∗ , {\displaystyle \ {\vec {p}}^{\,*}\ ,} across all discrete probability distributions p → {\displaystyle \ {\vec {p}}\ } on { x 1 , x 2 , … , x n }.

{\displaystyle \ \{x_{1},x_{2},\ldots ,x_{n}\}~.

} We require that: ∂ ∂ p → ( f + λ ( g − 1 ) ) | p → = p → ∗ = 0 , {\displaystyle \left.

{\frac {\partial }{\partial {\vec {p}}}}(f+\lambda (g-1))\right|_{{\vec {p}}={\vec {p}}^{\,*}}=0\ ,} which gives a system of n equations, k = 1 , … , n , {\displaystyle \ k=1,\ \ldots ,n\ ,} such that: ∂ ∂ p k { − ( ∑ j = 1 n p j log 2 ⁡ p j ) + λ ( ∑ j = 1 n p j − 1 ) } | p k = p ⋆ k = 0.

{\displaystyle \left.

{\frac {\partial }{\partial p_{k}}}\left\{-\left(\sum _{j=1}^{n}p_{j}\log _{2}p_{j}\right)+\lambda \left(\sum _{j=1}^{n}p_{j}-1\right)\right\}\right|_{p_{k}=p_{\star k}}=0~.

} Carrying out the differentiation of these n equations, we get − ( 1 ln ⁡ 2 + log 2 ⁡ p ⋆ k ) + λ = 0.

{\displaystyle -\left({\frac {1}{\ln 2}}+\log _{2}p_{\star k}\right)+\lambda =0~.

} This shows that all p ⋆ k {\displaystyle \ p_{\star k}\ } are equal (because they depend on λ only).

By using the constraint ∑ j p j = 1 , {\displaystyle \sum _{j}p_{j}=1\ ,} we find p ⋆ k = 1 n.

{\displaystyle p_{\star k}={\frac {1}{n}}~.

} Hence, the uniform distribution is the distribution with the greatest entropy, among distributions on n points.

Example 5 – Numerical optimization [ edit ] Lagrange multipliers cause the critical points to occur at saddle points (Example 5 ).

The magnitude of the gradient can be used to force the critical points to occur at local minima (Example 5 ).

The critical points of Lagrangians occur at saddle points , rather than at local maxima (or minima).

[4] [17] Unfortunately, many numerical optimization techniques, such as hill climbing , gradient descent , some of the quasi-Newton methods , among others, are designed to find local maxima (or minima) and not saddle points.

For this reason, one must either modify the formulation to ensure that it's a minimization problem (for example, by extremizing the square of the gradient of the Lagrangian as below), or else use an optimization technique that finds stationary points (such as Newton's method without an extremum seeking line search ) and not necessarily extrema.

As a simple example, consider the problem of finding the value of x that minimizes f ( x ) = x 2 , {\displaystyle \ f(x)=x^{2}\ ,} constrained such that x 2 = 1.

{\displaystyle \ x^{2}=1~.

} (This problem is somewhat untypical because there are only two values that satisfy this constraint, but it is useful for illustration purposes because the corresponding unconstrained function can be visualized in three dimensions.

) Using Lagrange multipliers, this problem can be converted into an unconstrained optimization problem: L ( x , λ ) = x 2 + λ ( x 2 − 1 ).

{\displaystyle {\mathcal {L}}(x,\lambda )=x^{2}+\lambda (x^{2}-1)~.

} The two critical points occur at saddle points where x = 1 and x = −1.

In order to solve this problem with a numerical optimization technique, we must first transform this problem such that the critical points occur at local minima.

This is done by computing the magnitude of the gradient of the unconstrained optimization problem.

First, we compute the partial derivative of the unconstrained problem with respect to each variable: ∂ L ∂ x = 2 x + 2 x λ ∂ L ∂ λ = x 2 − 1.

{\displaystyle {\begin{aligned}&{\frac {\partial {\mathcal {L}}}{\partial x}}=2x+2x\lambda \\[5pt]&{\frac {\partial {\mathcal {L}}}{\partial \lambda }}=x^{2}-1~.

\end{aligned}}} If the target function is not easily differentiable, the differential with respect to each variable can be approximated as ∂ L ∂ x ≈ L ( x + ε , λ ) − L ( x , λ ) ε , ∂ L ∂ λ ≈ L ( x , λ + ε ) − L ( x , λ ) ε , {\displaystyle {\begin{aligned}{\frac {\ \partial {\mathcal {L}}\ }{\partial x}}\approx {\frac {{\mathcal {L}}(x+\varepsilon ,\lambda )-{\mathcal {L}}(x,\lambda )}{\varepsilon }},\\[5pt]{\frac {\ \partial {\mathcal {L}}\ }{\partial \lambda }}\approx {\frac {{\mathcal {L}}(x,\lambda +\varepsilon )-{\mathcal {L}}(x,\lambda )}{\varepsilon }},\end{aligned}}} where ε {\displaystyle \varepsilon } is a small value.

Next, we compute the magnitude of the gradient, which is the square root of the sum of the squares of the partial derivatives: h ( x , λ ) = ( 2 x + 2 x λ ) 2 + ( x 2 − 1 ) 2 ≈ ( L ( x + ε , λ ) − L ( x , λ ) ε ) 2 + ( L ( x , λ + ε ) − L ( x , λ ) ε ) 2.

{\displaystyle {\begin{aligned}h(x,\lambda )&={\sqrt {(2x+2x\lambda )^{2}+(x^{2}-1)^{2}\ }}\\[4pt]&\approx {\sqrt {\left({\frac {\ {\mathcal {L}}(x+\varepsilon ,\lambda )-{\mathcal {L}}(x,\lambda )\ }{\varepsilon }}\right)^{2}+\left({\frac {\ {\mathcal {L}}(x,\lambda +\varepsilon )-{\mathcal {L}}(x,\lambda )\ }{\varepsilon }}\right)^{2}\ }}~.

\end{aligned}}} (Since magnitude is always non-negative, optimizing over the squared-magnitude is equivalent to optimizing over the magnitude.

Thus, the "square root" may be omitted from these equations with no expected difference in the results of optimization.

) The critical points of h occur at x = 1 and x = −1 , just as in L.

{\displaystyle {\mathcal {L}}~.

} Unlike the critical points in L , {\displaystyle {\mathcal {L}}\,,} however, the critical points in h occur at local minima, so numerical optimization techniques can be used to find them.

Applications [ edit ] Control theory [ edit ] In optimal control theory, the Lagrange multipliers are interpreted as costate variables, and Lagrange multipliers are reformulated as the minimization of the Hamiltonian , in Pontryagin's minimum principle.

Nonlinear programming [ edit ] The Lagrange multiplier method has several generalizations.

In nonlinear programming there are several multiplier rules, e.

g.

the Carathéodory–John Multiplier Rule and the Convex Multiplier Rule, for inequality constraints.

[18] Power systems [ edit ] Methods based on Lagrange multipliers have applications in power systems , e.

g.

in distributed-energy-resources (DER) placement and load shedding.

[19] Safe Reinforcement Learning [ edit ] The method of Lagrange multipliers applies to constrained Markov decision processes.

[20] It naturally produces gradient-based primal-dual algorithms in safe reinforcement learning.

[21] Normalized solutions [ edit ] Considering the PDE problems with constraints, i.

e.

, the study of the properties of the normalized solutions, Lagrange multipliers play an important role.

See also [ edit ] Adjustment of observations Duality Gittins index Karush–Kuhn–Tucker conditions : generalization of the method of Lagrange multipliers Lagrange multipliers on Banach spaces : another generalization of the method of Lagrange multipliers Lagrange multiplier test in maximum likelihood estimation Lagrangian relaxation References [ edit ] ^ Hoffmann, Laurence D.

; Bradley, Gerald L.

(2004).

Calculus for Business, Economics, and the Social and Life Sciences (8th ed.

).

pp.

575–588.

ISBN 0-07-242432-X.

^ Beavis, Brian; Dobbs, Ian M.

(1990).

"Static Optimization".

Optimization and Stability Theory for Economic Analysis.

New York: Cambridge University Press.

p.

40.

ISBN 0-521-33605-8.

^ Protter, Murray H.

; Morrey, Charles B.

Jr.

(1985).

Intermediate Calculus (2nd ed.

).

New York, NY: Springer.

p.

267.

ISBN 0-387-96058-9.

^ a b c Walsh, G.

R.

(1975).

"Saddle-point Property of Lagrangian Function".

Methods of Optimization.

New York, NY: John Wiley & Sons.

pp.

39–44.

ISBN 0-471-91922-5.

^ Kalman, Dan (2009).

"Leveling with Lagrange: An alternate view of constrained optimization".

Mathematics Magazine.

82 (3): 186–196.

doi : 10.

1080/0025570X.

2009.

11953617.

JSTOR 27765899.

S2CID 121070192.

^ a b Silberberg, Eugene; Suen, Wing (2001).

The Structure of Economics: A Mathematical Analysis (Third ed.

).

Boston: Irwin McGraw-Hill.

pp.

134–141.

ISBN 0-07-234352-4.

^ de la Fuente , Angel (2000).

Mathematical Methods and Models for Economists.

Cambridge: Cambridge University Press.

p.

285.

doi : 10.

1017/CBO9780511810756.

ISBN 978-0-521-58512-5.

^ Luenberger, David G.

(1969).

Optimization by Vector Space Methods.

New York: John Wiley & Sons.

pp.

188–189.

^ Bertsekas, Dimitri P.

(1999).

Nonlinear Programming (Second ed.

).

Cambridge, MA: Athena Scientific.

ISBN 1-886529-00-0.

^ Vapnyarskii, I.

B.

(2001) [1994], "Lagrange multipliers" , Encyclopedia of Mathematics , EMS Press.

^ Lasdon, Leon S.

(2002) [1970].

Optimization Theory for Large Systems (reprint ed.

).

Mineola, New York, NY: Dover.

ISBN 0-486-41999-1.

MR 1888251.

^ Hiriart-Urruty, Jean-Baptiste; Lemaréchal, Claude (1993).

"Chapter XII: Abstract duality for practitioners".

Convex analysis and minimization algorithms.

Grundlehren der Mathematischen Wissenschaften [Fundamental Principles of Mathematical Sciences].

Vol.

306.

Berlin, DE: Springer-Verlag.

pp.

136–193 (and Bibliographical comments pp.

334–335).

ISBN 3-540-56852-2.

MR 1295240.

Volume II: Advanced theory and bundle methods.

^ Lemaréchal, Claude (15–19 May 2000).

"Lagrangian relaxation".

In Jünger, Michael; Naddef, Denis (eds.

).

Computational combinatorial optimization: Papers from the Spring School held in Schloß Dagstuhl.

Spring School held in Schloß Dagstuhl, May 15–19, 2000.

Lecture Notes in Computer Science.

Vol.

2241.

Berlin, DE: Springer-Verlag (published 2001).

pp.

112–156.

doi : 10.

1007/3-540-45586-8_4.

ISBN 3-540-42877-1.

MR 1900016.

S2CID 9048698.

^ Lafontaine, Jacques (2015).

An Introduction to Differential Manifolds.

Springer.

p.

70.

ISBN 978-3-319-20735-3.

^ Dixit, Avinash K.

(1990).

"Shadow Prices".

Optimization in Economic Theory (2nd ed.

).

New York: Oxford University Press.

pp.

40–54.

ISBN 0-19-877210-6.

^ Chiang, Alpha C.

(1984).

Fundamental Methods of Mathematical Economics (Third ed.

).

McGraw-Hill.

p.

386.

ISBN 0-07-010813-7.

^ Heath, Michael T.

(2005).

Scientific Computing: An introductory survey.

McGraw-Hill.

p.

203.

ISBN 978-0-07-124489-3.

^ Pourciau, Bruce H.

(1980).

"Modern multiplier rules".

American Mathematical Monthly.

87 (6): 433–452.

doi : 10.

2307/2320250.

JSTOR 2320250.

^ Gautam, Mukesh; Bhusal, Narayan; Benidris, Mohammed (2020).

A sensitivity-based approach to adaptive under-frequency load shedding.

2020 IEEE Texas Power and Energy Conference (TPEC).

Institute of Electronic and Electrical Engineers.

pp.

1–5.

doi : 10.

1109/TPEC48276.

2020.

9042569.

^ Altman, Eitan (2021).

Constrained Markov Decision Processes.

Routledge.

^ Ding, Dongsheng; Zhang, Kaiqing; Jovanovic, Mihailo; Basar, Tamer (2020).

Natural policy gradient primal-dual method for constrained Markov decision processes.

Advances in Neural Information Processing Systems.

Further reading [ edit ] Beavis, Brian; Dobbs, Ian M.

(1990).

"Static Optimization".

Optimization and Stability Theory for Economic Analysis.

New York, NY: Cambridge University Press.

pp.

32–72.

ISBN 0-521-33605-8.

Bertsekas, Dimitri P.

(1982).

Constrained optimization and Lagrange multiplier methods.

New York, NY: Academic Press.

ISBN 0-12-093480-9.

Beveridge, Gordon S.

G.

; Schechter, Robert S.

(1970).

"Lagrangian multipliers".

Optimization: Theory and Practice.

New York, NY: McGraw-Hill.

pp.

244–259.

ISBN 0-07-005128-3.

Binger, Brian R.

; Hoffman, Elizabeth (1998).

"Constrained optimization".

Microeconomics with Calculus (2nd ed.

).

Reading: Addison-Wesley.

pp.

56–91.

ISBN 0-321-01225-9.

Carter, Michael (2001).

"Equality constraints".

Foundations of Mathematical Economics.

Cambridge, MA: MIT Press.

pp.

516–549.

ISBN 0-262-53192-5.

Hestenes, Magnus R.

(1966).

"Minima of functions subject to equality constraints".

Calculus of Variations and Optimal Control Theory.

New York, NY: Wiley.

pp.

29–34.

Wylie, C.

Ray; Barrett, Louis C.

(1995).

"The extrema of integrals under constraint".

Advanced Engineering Mathematics (Sixth ed.

).

New York, NY: McGraw-Hill.

pp.

1096–1103.

ISBN 0-07-072206-4.

External links [ edit ] The Wikibook Calculus optimization methods has a page on the topic of: Lagrange multipliers Exposition [ edit ] Steuard.

"Conceptual introduction".

slimy.

com.

— plus a brief discussion of Lagrange multipliers in the calculus of variations as used in physics.

Carpenter, Kenneth H.

"Lagrange multipliers for quadratic forms with linear constraints" (PDF).

Kansas State University.

Additional text and interactive applets [ edit ] Resnik.

"Simple explanation with an example of governments using taxes as Lagrange multipliers".

umiacs.

umd.

edu.

University of Maryland.

Klein, Dan.

"Lagrange multipliers without permanent scarring] Explanation with focus on the intuition" (PDF).

nlp.

cs.

berkeley.

edu.

University of California, Berkeley.

Sathyanarayana, Shashi.

"Geometric representation of method of Lagrange multipliers".

wolfram.

com ( Mathematica demonstration).

Wolfram Research.

Needs Internet Explorer / Firefox / Safari.

— Provides compelling insight in 2 dimensions that at a minimizing point, the direction of steepest descent must be perpendicular to the tangent of the constraint curve at that point.

"Lagrange multipliers – two variables".

MIT Open Courseware (ocw.

mit.

edu) (Applet).

Massachusetts Institute of Technology.

"Lagrange multipliers".

MIT Open Courseware (ocw.

mit.

edu) (video lecture).

Mathematics 18-02: Multivariable calculus.

Massachusetts Institute of Technology.

Fall 2007.

Bertsekas.

"Details on Lagrange multipliers" (PDF).

athenasc.

com (slides / course lecture).

Non-Linear Programming.

— Course slides accompanying text on nonlinear optimization Wyatt, John (7 April 2004) [19 November 2002].

"Legrange multipliers, constrained optimization, and the maximum entropy principle" (PDF).

www-mtl.

mit.

edu.

Elec E & C S / Mech E 6.

050 – Information, entropy, and computation.

— Geometric idea behind Lagrange multipliers "Using Lagrange multipliers in optimization".

matlab.

cheme.

cmu.

edu (MATLAB example).

Pittsburgh, PA: Carnegie Mellon University.

24 December 2011.

v t e Calculus Precalculus Binomial theorem Concave function Continuous function Factorial Finite difference Free variables and bound variables Graph of a function Linear function Radian Rolle's theorem Secant Slope Tangent Limits Indeterminate form Limit of a function One-sided limit Limit of a sequence Order of approximation (ε, δ)-definition of limit Differential calculus Derivative Second derivative Partial derivative Differential Differential operator Mean value theorem Notation Leibniz's notation Newton's notation Rules of differentiation linearity Power Sum Chain L'Hôpital's Product General Leibniz's rule Quotient Other techniques Implicit differentiation Inverse functions and differentiation Logarithmic derivative Related rates Stationary points First derivative test Second derivative test Extreme value theorem Maximum and minimum Further applications Newton's method Taylor's theorem Differential equation Ordinary differential equation Partial differential equation Stochastic differential equation Integral calculus Antiderivative Arc length Riemann integral Basic properties Constant of integration Fundamental theorem of calculus Differentiating under the integral sign Integration by parts Integration by substitution trigonometric Euler Tangent half-angle substitution Partial fractions in integration Quadratic integral Trapezoidal rule Volumes Washer method Shell method Integral equation Integro-differential equation Vector calculus Derivatives Curl Directional derivative Divergence Gradient Laplacian Basic theorems Line integrals Green's Stokes' Gauss' Multivariable calculus Divergence theorem Geometric Hessian matrix Jacobian matrix and determinant Lagrange multiplier Line integral Matrix Multiple integral Partial derivative Surface integral Volume integral Advanced topics Differential forms Exterior derivative Generalized Stokes' theorem Tensor calculus Sequences and series Arithmetico-geometric sequence Types of series Alternating Binomial Fourier Geometric Harmonic Infinite Power Maclaurin Taylor Telescoping Tests of convergence Abel's Alternating series Cauchy condensation Direct comparison Dirichlet's Integral Limit comparison Ratio Root Term Special functions and numbers Bernoulli numbers e (mathematical constant) Exponential function Natural logarithm Stirling's approximation History of calculus Adequality Brook Taylor Colin Maclaurin Generality of algebra Gottfried Wilhelm Leibniz Infinitesimal Infinitesimal calculus Isaac Newton Fluxion Law of Continuity Leonhard Euler Method of Fluxions The Method of Mechanical Theorems Lists Integrals rational functions irrational functions exponential functions logarithmic functions hyperbolic functions inverse trigonometric functions inverse Secant Secant cubed List of limits List of derivatives Miscellaneous topics Complex calculus Contour integral Differential geometry Manifold Curvature of curves of surfaces Tensor Euler–Maclaurin formula Gabriel's horn Integration Bee Proof that 22/7 exceeds π Regiomontanus' angle maximization problem Steinmetz solid v t e Joseph-Louis Lagrange Lagrange multiplier Lagrange polynomial Lagrange's four-square theorem Lagrange's theorem (group theory) Lagrange's identity Lagrange's identity (boundary value problem) Lagrange's trigonometric identities Lagrange multiplier Lagrangian mechanics Lagrange's mean value theorem Lagrange stability Lagrange point Retrieved from " https://en.

wikipedia.

org/w/index.

php?title=Lagrange_multiplier&oldid=1234120809 " Categories : Multivariable calculus Mathematical optimization Mathematical and quantitative methods (economics) Hidden categories: Articles with short description Short description is different from Wikidata Use dmy dates from March 2023 This page was last edited on 12 July 2024, at 17:55 (UTC).

Text is available under the Creative Commons Attribution-ShareAlike License 4.

0 ; additional terms may apply.

By using this site, you agree to the Terms of Use and Privacy Policy.

Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view.